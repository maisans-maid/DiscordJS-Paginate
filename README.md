# DiscordJS-Paginate
Simple utility to paginate discord message embeds with the new Buttons Components!

This project was initially intended to use for [Mai](https://github.com/maisans-maid/Mai), however, you can use this utility too. If you find any bugs/issues, don't hesitate to open an issue or make a pull request.

## Installation
For v12 of discord.js (Pagination by Emoji, not Buttons!)
```
npm i discordjs-paginate@0.0.5-bunnygirl
```
For the master dev branch of discord.js
```
npm i discordjs-paginate
```
Test the current build
```
npm i github:maisans-maid/DiscordJS-Paginate#master
```

## Basic Usage Example
```js
const { MessageEmbed } = require('discord.js');
const Paginate = require('discordjs-paginate');

// Build the embeds beforehand and place them inside an array
const embeds = [ new MessageEmbed(), new MessageEmbed(), new MessageEmbed() ]

// Pass in the array of message embeds and the discord.js message instance, then execute by using the exec() function
new Paginate(embeds, interaction).exec()
```

## Class Parameters
```js
new Paginate(embeds, interaction, options)
```
|Name|Type|Default value|isOptional|Description|
|:---:|:---:|:---:|:---:|---|
[embeds](https://discord.js.org/#/docs/main/stable/class/MessageEmbed)|array|`none`|false|The array of MessageEmbeds to paginate
[interaction](https://discord.js.org/#/docs/main/stable/class/Interaction) or [message](https://discord.js.org/#/docs/main/stable/class/Message)|object|`none`|false|The Interaction Object or Message Object reference for this pagination to use
[options](#PaginationOptions)|object|`{}`|true|The options for this pagination instance

### Allowing other users to paginate
To allow other users on paginating the embed, you will just have to pass an array containing the user id of all the users you want to have access to the paginated embed.
```js
new Paginate(embeds, interaction, {
  // Allow these 2 users other than the message author to paginate the embed
  allowedUsers: ['1234567890', '0987654321']
});
```

### Setting / Disabling timeouts
If you want to keep the pagination running (as long as your bot process does not end), you can set the timeout to 0 in the PaginationOptions. The same thing for setting timeouts. The timeout defaults to 90000 or 90 seconds.
```js
new Paginate(embeds, interaction, {
  timeout: 0     // pagination will never expire.

  timeout: 30000 // pagination will end after 30 seconds.
});
```

### Customizing the button and the button behaviors (Optional)

#### Custom label for the button
You can use your own labels for the buttons that would serve as the previous, next, or stop function of your pagination. Perhaps instead of an icon, you want to have the word "PREVIOUS" on your button. Just make sure to review the limits imposed by discord on length of the label.
```js
new Paginate(embeds, interaction, {
  buttons: {
    previous: {
      label: 'Previous'
    },
    next: {
      label: 'Next'
    }
  }
})
```

#### Using other button styles
By default, the color of the button generated by the pagination will be gray (Stop button defaults at red). To change this, you can select a style from [this list](https://discordjs.guide/interactions/buttons.html#button-styles) to go with your buttons. DO NOT USE LINK STYLE OR YOUR PAGINATION WILL NOT WORK!
```js
new Paginate(embeds, interaction, {
  buttons: {
    previous: {
      style: 'PRIMARY'
    },
    next: {
      style: 'SUCCESS'
    }
  }
})
```

### Using emojis
GuildEmojis can be assigned to the button of your choosing.
```js
new Paginate(embeds, interaction, {
  buttons: {
    stop: {
      emoji: '123456789012345678'
    }
  }
})
```

#### Disabling/Removing other buttons
You can choose to remove/disable buttons if you don't want your pagination to be clicked on previous or forcefully stopped. For example, you don't want the embed to show previous pages after the user clicked next, or don't want the pagination to be stopped manually.
```js
new Paginate(embeds, interaction, {
  buttons: {
    stop: {
      disable: true;
    },
    next: {
      exclude: true;
    }
  }
})
```
In case where both properties are true, the exclude takes precedence.

#### Disabling/Removing all buttons after the pagination.
After a user is done browsing through the pages, and the pagination timed out or the user forced-stop the pagination, you have the option to disable or remove all the buttons at the end.
```js
new Paginate(embeds, interaction, {
  // Disable all the buttons on the paginated message
  disableButtonsOnFinish: true,

  // Removes all the buttons on the paginated message
  removeButtonsOnFinish: true;
});
```
In case where both properties are true, the `options.removeButtonsOnFinish` takes precedence.


### Add page number on footer
If you want to add page number to the footer, you can set appendPageInfo to true inside the options object. By default, the footer would display (Page 1 of 3) at the very beginning of your footer. If you have placed a text on the footer, the text will be moved to give way to the page info. Make sure the footer doesn't exceed the limits imposed by Discord before adding this info.
```js
new Paginate(embeds, message, {
  // Place page info at the footer of every embed
  appendPageInfo: true
});
```
If you want to have your own format, say, in your own language with the page info, you can pass a string to pageInfoFormat with the format you would like to use, while using '%page' and '%total' as variables for the current page and the total page.
```js
new Paginate(embeds, interaction, {
  appendPageInfo: true,
  pageInfoFormat: '%page/%totalページ'
});
// Will show "1/3ページ" on footer, if the current page is 1 and there are 3 pages in all.
```
If you have text in your footer, and you used your own pageInfoFormat, you might notice that there is no space between the text, to solve this, you just have to insert a whitespace after your string in the pageInfoFormat.
```js
new Paginate(embeds, interaction, {
  appendPageInfo: true,
  pageInfoFormat: '%page/%totalページ\u2000|\u2000' // or you can just use a space instead
});
// Will show "1/3ページ  |  A footer text that i previously placed here." on footer, if the current page is 1 and there are 3 pages in all.
```

### Disabling Wrapping
Wrapping is when the pagination loops and displays the very first page when you click on next on the last page, or when it displays the very last page when you click prev on the first page. To disable this behavior, set the disableWrap option to true.
```js
new Paginate(embeds, interaction, {
  disableWrap: true // This will prevent the pagination from wrapping
});
```

### Editing from another message
Instead of sending a new message, you can use a previously sent message (authored by the bot) to use as the pagination message by passing the message object to the `editFrom` options.
```js
new Paginate(embeds, interaction, {
  editFrom: oldMessage // A discord Message Object authored by the bot.
});
```

### Editing the error message for unauthorized pagination users
Because of how interaction works, you need to respond to users who are not allowed to control the paginated embed. To do this, you can assign a value to the `errorMessage` property.

```js
new Paginate(embeds, interaction, {
  errorMessage: 'You are not allowed to control this component' // A discord Message Object authored by the bot.
});
```

Remember that whenever you want to start the pagination, you need to call the `.exec()` function.

## Class Methods
The Class provides a useful methods to interact with the Paginate class
### `.exec()`
Executes the pagination.

Returns: `Promise<Object>` An object containing both the collector and the message reference of the pagination.
### `.generateComponents()`
Generate the next (, previous, and stop, if included) button.

Returns: `MessageActionRow` Represents an action row containing message components.
### `.restoreComponents()`
Restores disabled buttons to their active state.

Returns: `Paginate` this instantiated class.
### `generateWEMO()`
Generates a WebhookEditMessageOptions.

Returns: `WebhookEditMessageOptions` Options that can be passed into editMessage.
### `.next()`
Cycle forwards through the Message Embed array and get the current page's Message Embed. Used internally by the class, but can be manually controlled.

Returns: `WebhookEditMessageOptions` Options that can be passed into editMessage.
### `.previous()`
Cycle backwards through the Message Embed array and get the current page's Message Embed. Used internally by the class, but can be manually controlled.

Returns: `WebhookEditMessageOptions` Options that can be passed into editMessage.
### `.stop()`
Stops the paginated embed. Used internally by the class, but can be manually controlled.

Returns: `Promise<void>` [Collector#stop](https://discord.js.org/#/docs/main/stable/class/Collector?scrollTo=stop)

## PaginationOptions
|Name|Type|Description|
|:---:|:---:|---|
disablewrap|`boolean`|Whether to disable the page wrapping or not.|
timeout|`number`| The timeout to use in milliseconds.|
errorMessage|`string`|The message to send to user when using a pagination that is not instantiated by them.|
disableButtonsOnFinish|`boolean`|Whether to disable all the buttons when the pagination ends, defaults to false.|
removeButtonsOnFinish|`boolean`|Whether to remove all the buttons when the pagination ends, defaults to false.|
appendPageInfo|`boolean`|Whether to append a page number to the footer of the embed, defaults to false.|
pageInfoFormat|`string`|The format of the pageInfo to append.|
allowedUsers|[`userId`]()| Array of user ids allowed to control the pagination embed.|
previous|[`ButtonOptions`](#ButtonOptions)|WThe option for the previous button.|
next|[`ButtonOptions`](#ButtonOptions)|The option for the next button.|
stop|[`ButtonOptions`](#ButtonOptions)|The option for the stop button.|
editFrom|`Message`|The Message Object to edit, if none, will send message instead.|

## ButtonOptions
|Name|Type|Description|
|:---:|:---:|---|
label|`string`| The text to be displayed on this button.|
style|[`MessageButtonStyle`](https://discordjs.guide/interactions/buttons.html#button-styles)| Style for this button.|
emoji|`RawEmoji`| Emoji for this button.|
disable|`boolean`| Make this button disabled throughout the whole pagination process.|
exclude|`boolean`| Do not show this button on the pagination embed.|
